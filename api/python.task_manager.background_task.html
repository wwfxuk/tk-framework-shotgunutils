

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>python.task_manager.background_task module &mdash; tk-framework-shotgunutils v5.6.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="python.task_manager.background_task_manager module" href="python.task_manager.background_task_manager.html" />
    <link rel="prev" title="python.task_manager package" href="python.task_manager.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> tk-framework-shotgunutils
          

          
          </a>

          
            
            
              <div class="version">
                v5.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">How To</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../shotgun_model.html">Shotgun Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shotgun_hierarchy_model.html">Shotgun Hierarchy Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shotgun_data.html">Shotgun Asynchronous Data Retriever</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_manager.html">Background Task Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html">Shotgun Toolkit Qt Settings Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shotgun_globals.html">Shotgun Globals Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_config.html">External Configuration Management</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="python.html">python package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="python.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="python.external_config.html">python.external_config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="python.settings.html">python.settings package</a></li>
<li class="toctree-l4"><a class="reference internal" href="python.shotgun_data.html">python.shotgun_data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="python.shotgun_globals.html">python.shotgun_globals package</a></li>
<li class="toctree-l4"><a class="reference internal" href="python.shotgun_model.html">python.shotgun_model package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="python.task_manager.html">python.task_manager package</a></li>
<li class="toctree-l4"><a class="reference internal" href="python.utils.html">python.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python.html#module-python">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="framework.html">framework module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tk-framework-shotgunutils</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">API</a> &raquo;</li>
        
          <li><a href="python.html">python package</a> &raquo;</li>
        
          <li><a href="python.task_manager.html">python.task_manager package</a> &raquo;</li>
        
      <li>python.task_manager.background_task module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/python.task_manager.background_task.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-python.task_manager.background_task">
<span id="python-task-manager-background-task-module"></span><h1>python.task_manager.background_task module<a class="headerlink" href="#module-python.task_manager.background_task" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="python.task_manager.background_task.BackgroundTask">
<em class="property">class </em><code class="descname">BackgroundTask</code><span class="sig-paren">(</span><em>task_id</em>, <em>cbl</em>, <em>group</em>, <em>priority</em>, <em>args</em>, <em>kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/python/task_manager/background_task.html#BackgroundTask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#python.task_manager.background_task.BackgroundTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Container class for a single task.</p>
<p>A task is a Python callable (function/method/class) that takes some arguments, does some work and returns its
result.  Each task will be run in a thread and tasks will be executed in priority order.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">task_fetch_status</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">status_of_something</span><span class="p">()</span>
<span class="o">...</span>
<span class="n">task_manager</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="n">task_fetch_status</span><span class="p">)</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">on_task_completion</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">result</span>
    <span class="c1"># do something with the status</span>
</pre></div>
</div>
<p>Additionally, tasks can be chained together so that the output of one task can be passed directly to the input
of one or more downstream tasks.  To achieve this, the upstream task must returns it’s result as a dictionary
and this dictionary is added to the named parameters of any downstream tasks by the task manager.  Care should
be taken when constructing these tasks that the result of one upstream task doesn’t unintentionally overwrite
any existing named parameters for a downstream task.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">task_fetch_status</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="n">status_of_something</span><span class="p">()}</span>
<span class="k">def</span> <span class="nf">task_do_something</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result_of_doing_something</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
<span class="o">...</span>
<span class="n">status_task_id</span> <span class="o">=</span> <span class="n">task_manager</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="n">task_fetch_status</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">work_task_id</span> <span class="o">=</span> <span class="n">task_manager</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="n">task_do_something</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">upstream_task_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">status_task_id</span><span class="p">])</span>
<span class="o">...</span>
<span class="k">def</span> <span class="nf">on_task_completion</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">task</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">work_task_id</span><span class="p">:</span>
        <span class="c1"># do something with the result</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Upstream tasks can be fed into multiple down-stream tasks and the task priority can also be different so for
example all status fetches could be set to happen before all do-somethings by setting the priority accordingly.
Down-stream tasks will also not start before it’s upstream tasks have completed.</p>
<dl class="method">
<dt id="python.task_manager.background_task.BackgroundTask.append_upstream_result">
<code class="descname">append_upstream_result</code><span class="sig-paren">(</span><em>result</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/python/task_manager/background_task.html#BackgroundTask.append_upstream_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#python.task_manager.background_task.BackgroundTask.append_upstream_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Append the result from an upstream task to this tasks kwargs.  In order for the result to be appended
to the task it must be a dictionary.  Each entry in the result dictionary is then added to the tasks
named parameters so care should be taken when building the tasks that named parameters for a downstream
task are not unintentionally overwritten by the result of an upstream task.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>result</strong> – A dictionary containing the result from an upstream task.  If result is not a dictionary
then it will be ignored.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="python.task_manager.background_task.BackgroundTask.group">
<code class="descname">group</code><a class="headerlink" href="#python.task_manager.background_task.BackgroundTask.group" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The group this task belongs to</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="python.task_manager.background_task.BackgroundTask.priority">
<code class="descname">priority</code><a class="headerlink" href="#python.task_manager.background_task.BackgroundTask.priority" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The priority for this task</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="python.task_manager.background_task.BackgroundTask.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/python/task_manager/background_task.html#BackgroundTask.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#python.task_manager.background_task.BackgroundTask.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform this task</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The result of performing the task</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="python.task_manager.background_task.BackgroundTask.uid">
<code class="descname">uid</code><a class="headerlink" href="#python.task_manager.background_task.BackgroundTask.uid" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The unique id of this task</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="python.task_manager.background_task_manager.html" class="btn btn-neutral float-right" title="python.task_manager.background_task_manager module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="python.task_manager.html" class="btn btn-neutral float-left" title="python.task_manager package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Shotgun Software

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>